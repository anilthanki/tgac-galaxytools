<tool id="blast_parser" name="BLAST parser" version="0.1.2">
    <description>
        Convert 12- or 24-column BLAST output into 3-column hcluster_sg input
    </description>
    <command detect_errors="exit_code">
<![CDATA[
python '$__tool_directory__/blast_parser.py'
-i '$input'
-o '$output'
#if $ensembl_conditional.ensembl == 'e'
    -e '$ensembl_conditional.ensembl_version'
#else if $ensembl_conditional.reciprocal
    -r
#end if
]]>
    </command>

    <inputs>
        <param name="input" type="data" format="tabular" label="Tabular data" help="BLAST 12 column tabular format data"/>
         <conditional name="ensembl_conditional">
            <param argument="ensembl" type="select" label="Ensembl Params" help="returns results which fulfills Ensembl conditions mentioned below">
                <option value="e" selected="true">Yes</option>
                <option value="">No</option>
            </param>
            <when value="e">
                <param name="ensembl_version" argument="ensembl_v" type="select" label="Choose the workflow iteration" help="for iteration 1 returns results which are either reciprocal BLAST hit or having BLAST Score Ratio more than 0.33 and iteration 2 will return results having BLAST Score Ratio (BSR) more than 0.11">
                    <option value="1" selected="true">1 - (Recioprocal BLAST Hit or BSR > 0.33)</option>
                    <option value="2">2 - (BSR > 0.11)</option>
                </param>
            </when>

            <when value="">
                <param name="reciprocal" type="boolean" checked="false" label="Reciprocal results" help="returns only reciprocal results"/>
            </when>
        </conditional>
    </inputs>

    <outputs>
        <data name="output" format="tabular" label="$tool.name on ${on_string}" />
    </outputs>

    <tests>
        <test>
            <param name="input" ftype="tabular" value="input.tabular" />
            <param name="reciprocal" value="false" />
            <output name="output" file="output.tabular" />
        </test>
        <test>
            <param name="input" ftype="tabular" value="input.tabular" />
            <param name="reciprocal" value="true" />
            <output name="output" file="output2.tabular" />
        </test>
    </tests>
    <help>
<![CDATA[
Simple tool to convert a 24-column BLAST output into a 3-column format (qseqid, sseqid, round(-1 * log10(evalue)/2)) usable as input for the hcluster_sg tool. It also has filtered option where it considers either Ensembl parameters mentioned in `"EnsemblCompara GeneTrees"`_ or has a filter for reciprocal BLAST.

.. _"EnsemblCompara GeneTrees": http://genome.cshlp.org/content/19/2/327.long
]]>
    </help>
    <citations>
    </citations>
</tool>
